\documentclass[10pt, a4paper]{ReportSheet}

%%%%% Preamble with packages
%%%%% ---------------------------------------------------------------
\include{preamble}

%%%%% Hyperlink configuration
%%%%% ------------------------------------------------------------
\hypersetup{pdftitle=MMAD - Úkol 1}

%%%%% Main document
%%%%% ------------------------------------------------------------
\begin{document}
%%% content
%%% --- title, author, date
    \title{MMAD - Úkol 1}
    \author{Filip Ditrich}
    \date{
        \footnotesize{
            \centering{
                Unicorn University, Prague, Czech Republic\\
                \today
            }
        }
    }
    \maketitle

%%% Obsah
    \setcounter{tocdepth}{1}
    \pagestyle{plain}
    \renewcommand{\contentsname}{}
    \addtocontents{toc}{\vskip -2em}
    \tableofcontents

% -- Úloha 1
    \uloha{1}{3}{
        Dokažte, že každá ortogonální matice má determinant $\pm 1$.
    }{
        Ortogonální matice je čtvercová reálná matice $Q$, která splňuje podmínku:
        \begin{equation*}
            Q^{TQ} = QQ^T = I
        \end{equation*}
        kde $I$ je jednotková matice.

        Dále platí, že determinant součinu dvou matic je roven součinu determinantů těchto matic, tedy:
        \begin{equation*}
            det(Q^{TQ}) = det(Q) \cdot det(Q^T)
        \end{equation*}

        Determinant jednotkové matice je vždy 1:
        \begin{equation*}
            det(I) = 1
        \end{equation*}

        Z předchozích vztahů plyne, že:
        \begin{equation*}
            det(Q^{TQ}) = det(I) = 1
        \end{equation*}

        Dá se také zapsat jako:
        \begin{equation*}
            det(Q) \cdot det(Q) = det(Q)^2 = 1
        \end{equation*}

        Odtud již plyne, že determinant ortogonální matice je roven $\pm 1$, jelikož:
        \begin{equation*}
            \sqrt{det(Q)^2} = \sqrt{1} = \pm 1
        \end{equation*}

        \answerbox{
            Ano, každá ortogonální matice má determinant $\pm 1$.
        }{}
    }

% -- Úloha 2
    \uloha{2}{3}{
        Pokud mají matice $A$ i $B$ stejná vlastní čísla, platí i, že $A \times B$ mají ty samá vlastní čísla?
    }{
        Neplatí. Uvažme matice
        \begin{equation*}
            A = \begin{pmatrix}
                    1 & 0 \\
                    0 & 2
            \end{pmatrix}
            \quad
            B = \begin{pmatrix}
                    2 & 0 \\
                    0 & 1
            \end{pmatrix}
        \end{equation*}
        Obě matice mají stejná vlastní čísla:
        \begin{equation*}
            \begin{aligned}
                det(A - \lambda I) &= 0 \Rightarrow (1 - \lambda)(2 - \lambda) = 0 \Rightarrow \lambda_1 = 1, \lambda_2 = 2 \\
                det(B - \lambda I) &= 0 \Rightarrow (2 - \lambda)(1 - \lambda) = 0 \Rightarrow \lambda_1 = 1, \lambda_2 = 2
            \end{aligned}
        \end{equation*}

        ale jejich součin:
        \begin{equation*}
            A \times B = \begin{pmatrix}
                             2 & 0 \\
                             0 & 2
            \end{pmatrix}
        \end{equation*}
        již vlastní čísla stejná nemají:
        \begin{equation*}
            det(A \times B - \lambda I) = det\begin{pmatrix}
                                                 2 - \lambda & 0           \\
                                                 0           & 2 - \lambda
            \end{pmatrix} = (2 - \lambda)^2 = 0 \Rightarrow \lambda = 2
        \end{equation*}

        Kdyby však matice $A$ a $B$ byly navzájem komutativní, tedy $A \times B = B \times A$, pak by platilo, že $A \times B$ mají stejná vlastní čísla jako $B \times A$, protože vlastní čísla matice jsou nezávislá na pořadí násobení:
        \begin{equation*}
            det(A \times B - \lambda I) = det(B \times A - \lambda I)
        \end{equation*}

        \answerbox{Ne, pokud matice $A$ a $B$ nemají stejná vlastní čísla, pak ani jejich součin $A \times B$ nemusí
        mít stejná vlastní čísla.}{}
    }

% -- Úloha 3
    \uloha{3}{3}{
        Rozhodněte, zda je následující matice diagonalizovatelná

        \[
            A = \begin{pmatrix}
                    0  & 1 & 2 \\
                    -4 & 1 & 4 \\
                    -5 & 1 & 7
            \end{pmatrix}
        \]
    }{
        Diagonalizovatelná matice je taková reálná čtvercová matice o rozměrech $n \times n$, která má $n$ navzájem různých
        vlastních čísel.

        Vlastní čísla matice $A$ jsou řešením rovnice $\det(A - \lambda I) = 0$:
        \begin{equation*}
            det(A - \lambda I) = \begin{vmatrix}
                                     -\lambda & 1           & 2           \\
                                     -4       & 1 - \lambda & 4           \\
                                     -5       & 1           & 7 - \lambda
            \end{vmatrix} = 0
        \end{equation*}

        Po úpravě dostaneme charakteristický polynom:
        \begin{equation*}
            p_A(\lambda) = -\lambda^3 + 8\lambda^2 - 17\lambda + 10 = 0
        \end{equation*}

        Tuto rovnici následovně upravíme:
        \begin{equation*}
            \begin{aligned}
                -\lambda^3 + 8\lambda^2 - 17\lambda + 10 &= 0 \\
                \cdots \\
                (\lambda - 1) \times (\lambda - 2) \times (\lambda - 5) &= 0
            \end{aligned}
        \end{equation*}

        A tím získáme kořeny charakteristické rovnice a tedy vlastní čísla matice $A$:
        \begin{equation*}
            \begin{aligned}
                \lambda_1 &= 1 \\
                \lambda_2 &= 2 \\
                \lambda_3 &= 5
            \end{aligned}
        \end{equation*}

        Jelikož $\lambda_1 \ne \lambda_2 \ne \lambda_3$, matice $A$ má 3 různá vlastní čísla a tedy je diagonalizovatelná.
        \answerbox{
            Ano, matice $A$ je diagonalizovatelná.
        }{}
    }

% -- Úloha 4
    \uloha{4}{3}{
        Nalezněte vlastní vektor příslušný k nejmenšímu a největšímu vlastnímu číslu matice $A$ z předchozího příkladu.
    }{
        Vlastní vektory matice $A$ jsou řešením soustavy rovnic $(A - \lambda I)x = 0$, kde $\lambda$ je vlastní číslo matice $A$.

        Nejmenší a největší vlastní čísla matice $A$ jsou $\lambda_{\min} = 1$ a $\lambda_{\max} = 5$.

        Pro $\lambda_{\min} = 1$:
        \begin{equation*}
            \begin{aligned}
            (A - 1I)
                x &= \begin{pmatrix}
                         -1 & 1 & 2 \\
                         -4 & 0 & 4 \\
                         -5 & 1 & 6
                \end{pmatrix} \begin{pmatrix}
                                  x_1 \\
                                  x_2 \\
                                  x_3
                \end{pmatrix} = \begin{pmatrix}
                                    0 \\
                                    0 \\
                                    0
                \end{pmatrix}
            \end{aligned}
        \end{equation*}

        Po úpravě dostaneme:
        \begin{equation*}
            \begin{aligned}
                x_1 - x_3 &= 0 \\
                x_2 + x_3 &= 0
            \end{aligned}
        \end{equation*}

        Řešením této soustavy rovnic je vlastní vektor $p$:
        \begin{equation*}
            p = \begin{pmatrix}
                    1  \\
                    -1 \\
                    1
            \end{pmatrix}
        \end{equation*}

        Pro $\lambda_{\max} = 5$:
        \begin{equation*}
            \begin{aligned}
            (A - 5I)
                x &= \begin{pmatrix}
                         -5 & 1  & 2 \\
                         -4 & -4 & 4 \\
                         -5 & 1  & 2
                \end{pmatrix} \begin{pmatrix}
                                  x_1 \\
                                  x_2 \\
                                  x_3
                \end{pmatrix} = \begin{pmatrix}
                                    0 \\
                                    0 \\
                                    0
                \end{pmatrix}
            \end{aligned}
        \end{equation*}

        Po úpravě dostaneme:
        \begin{equation*}
            \begin{aligned}
                x_1 - \frac{1}{2}x_3 &= 0 \\
                x_2 - \frac{1}{2}x_3 &= 0
            \end{aligned}
        \end{equation*}

        Řešením této soustavy rovnic je vlastní vektor $s$:
        \begin{equation*}
            s = \begin{pmatrix}
                    \frac{1}{2} \\
                    \frac{1}{2} \\
                    1
            \end{pmatrix}
        \end{equation*}

        \answerbox{
            Vlastní vektor příslušný nejmenšímu vlastnímu číslu $\lambda_{\min} = 1$ je $p = (1, -1, 1)^T$ a vlastní
            vektor příslušný největšímu vlastnímu číslu $\lambda_{\max} = 5$ je $s = \left(\frac{1}{2}, \frac{1}{2}, 1\right)^T$.
        }{}
    }

% -- Úloha 5
    \uloha{5}{3}{
        Mějme stálý migrační proces obyvatel mezi Severem, Jihem, Východem a Západem, jehož průběh za 1 rok lze znázornit diagramem níže (desetinná čísla udávají, jaký zlomek populace se za rok přemístí po šipce do jiné oblasti). Na počátku je počet obyvatel ve všech oblastech 10 milionů.

        \begin{itemize}
            \item 5a) Jak bude situace rozložení populace vypadat za 10 let od počátku?
            \item 5b) Na kterých hodnotách se populace v jednotlivých oblastech ustálí, pokud ji budeme dostatečně dlouho sledovat?
        \end{itemize}

        Využijte libovolný počítačový nástroj a své argumenty podpořte výstupy tohoto nástroje.

        \begin{figure}[H]
            \centering
            \includegraphics[width=0.5\textwidth]{\FIGDIR/ukol-1-5-diagram}
            \caption{Diagram stálého migračního procesu obyvatel mezi Severem, Jihem, Východem a Západem.}
            \label{fig:population-migration}
        \end{figure}
        \source{}
    }{
        Pro řešení této úlohy využijeme jazyk Python a knihovnu \texttt{numpy} pro práci s maticemi a vektory.
    }{false}

    \textbf{\textit{5a) Jak bude situace rozložení populace vypadat za 10 let od počátku?}}

    Nejprve si vytvoříme matici přechodů $P$ a vektor počátečního rozložení populace $x_0$:
    \begin{minted}{python}
        import numpy as np

        # matice přechodů
        P = np.array([
            # Sever -> S, J, V, Z
            [0.75, 0.25, 0, 0],
            # Jih -> S, J, V, Z
            [0, 0.25, 0.25, 0.5],
            # Východ -> S, J, V, Z
            [0, 0.25, 0.75, 0],
            # Západ -> S, J, V, Z
            [0.25, 0, 0, 0.75]
        ]).T

        # počáteční rozložení populace
        x0 = np.array([10, 10, 10, 10])
    \end{minted}

    Následně provedeme výpočet rozložení populace za 10 let:
    \begin{minted}{python}
        # výpočet rozložení populace za 10 let
        x = x0
        for _ in range(10):
            x = np.dot(P, x) # P * x
        print(x)
        # [13.05176735  6.66666985  6.94823265 13.33333015]
    \end{minted}

    \answerbox{
        Výsledné rozložení populace po 10 letech bude:
        \begin{equation*}
            S &\approx 13.05 \text{ mil.}; \\
            J &\approx 6.67 \text{ mil.}; \\
            V &\approx 6.95 \text{ mil.}; \\
            Z &\approx 13.33 \text{ mil.}
        \end{equation*}
    }{5a}

    \vspace{5em}

    \textbf{\textit{5b) Na kterých hodnotách se populace v jednotlivých oblastech ustálí, pokud ji budeme dostatečně
    dlouho sledovat?}}

    Pro řešení této otázky můžeme využít vlastních vektorů a vlastních čísel matice přechodů $P$.
    Vlastní vektor příslušný vlastnímu číslu 1 nám řekne, na kterých hodnotách se populace ustálí po dostatečně dlouh
    é době (tj. po nekonečně mnoho letech).
    \begin{minted}{python}
        # vlastní čísla a vektory matice P
        w, v = np.linalg.eig(P)
        # vlastní čísla: [0.25 0.5 1. 0.75]
        # vlastní vektory: [
        #   [ 3.16227766e-01 -6.32455532e-01 -6.32455532e-01  7.07106781e-01]
        #   [ 6.32455532e-01 -3.16227766e-01 -3.16227766e-01  4.44605073e-17]
        #   [-3.16227766e-01  3.16227766e-01 -3.16227766e-01 -7.07106781e-01]
        #   [-6.32455532e-01  6.32455532e-01 -6.32455532e-01  2.03628341e-15]
        # ]
        print(w)
        print(v)

        # vlastní vektor příslušný vlastnímu číslu 1
        v1 = v[:, np.isclose(w, 1)]
        # [[-0.63245553], [-0.31622777], [-0.31622777], [-0.63245553]]

        # normalizace vlastního vektoru
        v1 = v1 / np.sum(v1)
        # [[0.33333333] [0.16666667], [0.16666667], [0.33333333]]
    \end{minted}

    \answerbox{
        Pokud budeme populaci dostatečně dlouho sledovat, ustálí se na hodnotách:
        \begin{equation*}
            S &\approx 33.33\%; \\
            J &\approx 16.67\%; \\
            V &\approx 16.67\%; \\
            Z &\approx 33.33\%
        \end{equation*}
    }{5b}

    \textit{
        Úplný zdrojový kód je k nalezení v souboru \href{https://github.com/filipditrich/MMAD-2024/blob/main/ukol-1-5.py}{ukol-1-5.py}.
    }
    \newpage

% -- Úloha 6
    \uloha{6}{3}{
        Na adrese \url{https://openmv.net/file/room-temperature.csv} naleznete soubor s daty. Jedná se o simulovaná data měření teploty v místnosti. Data jsou v .csv formátu. Obsahují hlavičku a pět sloupců. V prvním sloupci je datum, v následujících čtyřech sloupcích jsou teploty měření v jednotlivých čtyřech rozích místnosti.

        Celkem je v souboru 144 záznamů měření. Pokud bychom chtěli s takovými daty dále pracovat, kolik hlavních komponent (a jaké) je vhodné zvolit a proč?
        Využijte SVD rozkladu a libovolného počítačového nástroje a své argumenty podpořte výstupy těchto nástrojů. Nezapomeňte na úvodní transformaci dat.
    }{
        Pro vyřešení této úlohy využijeme jazyk Python a knihovny \texttt{pandas} a \texttt{numpy} pro práci s
        maticemi a vektory.
    }{false}
% answer must be outside the \uloha command, since \minted cannot be used inside it
    Nejprve načteme data z CSV souboru a provedeme úvodní transformaci dat.
    \begin{minted}{python}
        import pandas as pd
        import numpy as np

        # načtení dat
        data = pd.read_csv('room-temperature.csv')
        # zahození sloupce s datem (nepotřebné pro analýzu)
        data = data.drop(columns=['Date'])
        # normalizace dat (odstranění průměru)
        data = data - data.mean()
    \end{minted}

    Následně provedeme SVD rozklad matice dat a zjistíme, kolik hlavních komponent je vhodné zvolit.
    \begin{minted}{python}
        # SVD rozklad
        U, s, V = np.linalg.svd(data, full_matrices=False)
        # s = [34.54408633 16.15976563  7.69262365  6.51293724]

        # výpočet vysvětlené variance
        explained_variance = np.square(s) / np.sum(np.square(s))
        # explained_variance = [0.76688522 0.16782361 0.03803049 0.02726068]

        # zjištění počtu komponent pro 95% vysvětlené variance
        components = np.argmax(np.cumsum(explained_variance) > 0.95) + 1
        # components = 3
    \end{minted}

    \answerbox{
        Z výsledků SVD rozkladu zjistíme, že pro dosažení 95\% vysvětlené variance je vhodné zvolit 3 hlavní komponenty.
    }{}

    \textit{
        Úplný zdrojový kód je k nalezení v souboru \href{https://github.com/filipditrich/MMAD-2024/blob/main/ukol-1-6.py}{ukol-1-6.py}.
    }
    \newpage
\end{document}
